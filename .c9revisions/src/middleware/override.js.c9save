{"ts":1364670608734,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1364670757195,"patch":[[{"diffs":[[1,"var url = require('url');\nvar JSON_MIME = 'application/json';\n\nexports.acceptOverride = function (key) {\n  key = key || '_accept';\n  return function (req, res, next) {\n       if (req.query[key] == JSON_MIME\n  \t   || url.parse(req.url).pathname.match(/\\.json$/)) {\n      // url ends with json\n      req.headers.accept = JSON_MIME;\n    };\n    next();\n  };\n}\n\nexports.methodOverride = function (key) {\n  key = key || \"_method\";\n  return function methodOverride(req, res, next) {\n    req.originalMethod = req.originalMethod || req.method;\n\n    // req.body\n    if (req.body && key in req.body) {\n      req.method = req.body[key].toUpperCase();\n      delete req.body[key];\n\n    // req.query\n    } else if (req.query && key in req.query) {\n      req.method = req.query[key].toUpperCase();\n      delete req.query[key]\n\n    // check X-HTTP-Method-Override\n    } else if (req.headers['x-http-method-override']) {\n      req.method = req.headers['x-http-method-override'].toUpperCase();\n    } else if (req.headers['x-http-method']) {\n        req.method = req.headers['x-http=method'].toUpperCase();\n    }\n    \n    next();\n  };\n};\n"]],"start1":0,"start2":0,"length1":0,"length2":1118}]],"length":1118,"saved":false}
{"ts":1364670773750,"patch":[[{"diffs":[[0,"json';\n\n"],[1,"//accept override\n"],[0,"exports."]],"start1":55,"start2":55,"length1":16,"length2":34},{"diffs":[[0,"\n  };\n}\n"],[1,"// method override"],[0,"\nexports"]],"start1":366,"start2":366,"length1":16,"length2":34}]],"length":1154,"saved":false}
{"contributors":[],"silentsave":false,"ts":1364676927367,"patch":[[{"diffs":[[0,"\n\n//"],[-1,"accept override"],[1," todo: implement accept override using $format query"],[0,"\nexp"]],"start1":61,"start2":61,"length1":23,"length2":60},{"diffs":[[0,") {\n"],[-1,"  key = key || '_accept';\n"],[0,"  re"]],"start1":156,"start2":156,"length1":34,"length2":8},{"diffs":[[0,"    "],[-1,"   if (req.query[key] == JSON_MIME\n  \t   || url.parse(req.url).pathname.match(/\\.json$/)) {\n      // url ends with json\n      req.headers.accept = JSON_MIME;\n    };\n    next();\n  };\n}\n// method override"],[1,"next();\n  };\n}\n\n//handle custom http verb using  x-http-method"],[0,"\nexp"]],"start1":197,"start2":197,"length1":210,"length2":70},{"diffs":[[0,") {\n"],[-1,"  key = key || \"_method\";\n"],[0,"  re"]],"start1":302,"start2":302,"length1":34,"length2":8},{"diffs":[[0,"    "],[-1,"req.originalMethod = req.originalMethod || req.method;\n\n    // req.body\n    if (req.body && key in req.body) {\n      req.method = req.body[key].toUpperCase();\n      delete req.body[key];\n\n    // req.query\n    } else if (req.query && key in req.query) {\n      req.method = req.query[key].toUpperCase();\n      delete req.query[key]\n\n    // check X-HTTP-Method-Override\n    } else "],[0,"if ("]],"start1":357,"start2":357,"length1":386,"length2":8},{"diffs":[[0,";\n    } "],[1,"\n    "],[0,"else if "]],"start1":476,"start2":476,"length1":16,"length2":21},{"diffs":[[0,"['x-http"],[-1,"="],[1,"-"],[0,"method']"]],"start1":562,"start2":562,"length1":17,"length2":17}]],"length":626,"saved":false}
{"ts":1364676934444,"patch":[[{"diffs":[[0,"\n  };\n};"],[-1,"\n"]],"start1":617,"start2":617,"length1":9,"length2":8}]],"length":625,"saved":false}
